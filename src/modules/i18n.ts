import { createContext, useContext } from 'react'

export const translations = {
  en: {
    'app.eyebrow': 'Sun Path Atlas',
    'app.title': 'Professional Sun Path Diagram',
    'app.subtitle': 'A clean, verifiable sun-path toolkit for architecture and outdoor planning.',
    'app.mode.label': 'Mode',
    'app.mode.day': 'Single day',
    'app.mode.year': 'Year overview',
    'app.language': 'Language',
    'app.theme': 'Theme',
    'lang.en': 'English',
    'lang.zh': '中文',
    'theme.system': 'System',
    'theme.light': 'Light',
    'theme.dark': 'Dark',
    'controls.location': 'Location',
    'controls.map': 'Map picker',
    'controls.latitude': 'Latitude',
    'controls.longitude': 'Longitude',
    'controls.latPlaceholder': 'e.g. 30',
    'controls.lonPlaceholder': 'e.g. 120',
    'controls.helper': 'Supports N/S/E/W via sign. Basic range validation is applied.',
    'controls.dateTime': 'Date & Time',
    'controls.date': 'Date',
    'controls.timezone': 'Timezone offset',
    'controls.tzPlaceholder': 'UTC+08:00',
    'controls.dst': 'DST +1h',
    'controls.time': 'Time',
    'controls.timeHint': 'Local time (manual TZ)',
    'controls.export': 'Export',
    'controls.exportSvg': 'Export SVG',
    'controls.exportPng': 'Export PNG',
    'controls.mapHint': 'Click anywhere to pick coordinates.',
    'chart.eyebrow': 'Solar Geometry',
    'chart.title': 'Sun Path Diagram',
    'chart.yearTitle': 'Sun Path Year Overview',
    'chart.legend.monthSet': 'Monthly representative tracks',
    'chart.legend.above': 'Above horizon',
    'chart.legend.below': 'Below horizon',
    'chart.legend.selected': 'Selected time',
    'chart.legend.golden': 'Golden hour',
    'chart.legend.blue': 'Blue hour',
    'chart.dragHint': 'Drag to rotate, scroll to zoom, and inspect the 3D sky sphere.',
    'stats.sunrise': 'Sunrise',
    'stats.solarNoon': 'Solar noon',
    'stats.sunset': 'Sunset',
    'stats.daylight': 'Daylight',
    'stats.civil': 'Civil twilight',
    'stats.nautical': 'Nautical twilight',
    'stats.astronomical': 'Astronomical',
    'stats.golden': 'Golden hour',
    'stats.blue': 'Blue hour',
    'stats.azimuth': 'Azimuth',
    'stats.altitude': 'Altitude',
    'stats.yearLongest': 'Longest daylight',
    'stats.yearShortest': 'Shortest daylight',
    'stats.yearMaxNoon': 'Max noon altitude',
    'stats.yearMinNoon': 'Min noon altitude',
    'stats.yearReference': 'Reference year',
    'stats.yearReferenceDate': 'Selected month',
    'notes.selectedTime': 'Selected time',
    'notes.localDayLength': 'Local day length',
    'notes.sunMinus6': 'Sun -6°',
    'notes.sunMinus12': 'Sun -12°',
    'notes.sunMinus18': 'Sun -18°',
    'notes.sun0to6': 'Sun 0°–6°',
    'notes.sunMinus6to0': 'Sun -6°–0°',
    'notes.polarDay': 'Polar day',
    'notes.polarNight': 'Polar night',
    'notes.sunAbove': 'Sun above horizon',
    'notes.sunBelow': 'Sun below horizon',
    'status.noaa': 'NOAA simplified',
    'status.polarDay': 'Polar day',
    'status.polarNight': 'Polar night',
    'status.year': 'Yearly overlay',
    'error.latRequired': 'Latitude is required.',
    'error.latNumber': 'Latitude must be a number.',
    'error.latRange': 'Latitude must be between -90 and 90.',
    'error.lonRequired': 'Longitude is required.',
    'error.lonNumber': 'Longitude must be a number.',
    'error.lonRange': 'Longitude must be between -180 and 180.',
    'error.tzRequired': 'Timezone is required.',
    'error.tzFormat': 'Use format UTC+08:00 or UTC-05:00.',
    'geo.north': 'N',
    'geo.south': 'S',
    'geo.east': 'E',
    'geo.west': 'W',
    'footer.note':
      'Solar position and sunrise/sunset use NOAA-style simplified formulas (no refraction). Twilight bands use standard sun-altitude thresholds (-6°, -12°, -18°). Golden/blue hour follow configurable altitude ranges.',
  },
  zh: {
    'app.eyebrow': 'Sun Path Atlas',
    'app.title': '专业级太阳路径图谱',
    'app.subtitle': '面向建筑、摄影与户外规划的简洁可信工具。',
    'app.mode.label': '模式',
    'app.mode.day': '单日模式',
    'app.mode.year': '全年概览',
    'app.language': '语言',
    'app.theme': '主题',
    'lang.en': 'English',
    'lang.zh': '简体中文',
    'theme.system': '跟随系统',
    'theme.light': '浅色',
    'theme.dark': '深色',
    'controls.location': '地点',
    'controls.map': '地图点选',
    'controls.latitude': '纬度',
    'controls.longitude': '经度',
    'controls.latPlaceholder': '例如 30',
    'controls.lonPlaceholder': '例如 120',
    'controls.helper': '可用正负号表示南北/东西，经纬度范围有基础校验。',
    'controls.dateTime': '日期与时间',
    'controls.date': '日期',
    'controls.timezone': '时区偏移',
    'controls.tzPlaceholder': 'UTC+08:00',
    'controls.dst': '夏令时 +1h',
    'controls.time': '时间',
    'controls.timeHint': '本地时间（手动时区）',
    'controls.export': '导出',
    'controls.exportSvg': '导出 SVG',
    'controls.exportPng': '导出 PNG',
    'controls.mapHint': '点击地图任意位置选择坐标。',
    'chart.eyebrow': '太阳几何',
    'chart.title': '太阳路径图',
    'chart.yearTitle': '全年太阳路径概览',
    'chart.legend.monthSet': '每月代表日轨迹',
    'chart.legend.above': '地平线上方',
    'chart.legend.below': '地平线下方',
    'chart.legend.selected': '选定时刻',
    'chart.legend.golden': '黄金时刻',
    'chart.legend.blue': '蓝调时刻',
    'chart.dragHint': '拖动可旋转，滚轮可缩放，查看 3D 天球与太阳位置。',
    'stats.sunrise': '日出',
    'stats.solarNoon': '太阳正午',
    'stats.sunset': '日落',
    'stats.daylight': '日照时长',
    'stats.civil': '民用晨昏',
    'stats.nautical': '航海晨昏',
    'stats.astronomical': '天文晨昏',
    'stats.golden': '黄金时刻',
    'stats.blue': '蓝调时刻',
    'stats.azimuth': '方位角',
    'stats.altitude': '高度角',
    'stats.yearLongest': '全年最长日照',
    'stats.yearShortest': '全年最短日照',
    'stats.yearMaxNoon': '正午最高高度角',
    'stats.yearMinNoon': '正午最低高度角',
    'stats.yearReference': '参考年份',
    'stats.yearReferenceDate': '选中月份',
    'notes.selectedTime': '选定时刻',
    'notes.localDayLength': '当地日照时长',
    'notes.sunMinus6': '太阳高度 -6°',
    'notes.sunMinus12': '太阳高度 -12°',
    'notes.sunMinus18': '太阳高度 -18°',
    'notes.sun0to6': '太阳高度 0°–6°',
    'notes.sunMinus6to0': '太阳高度 -6°–0°',
    'notes.polarDay': '极昼',
    'notes.polarNight': '极夜',
    'notes.sunAbove': '太阳始终在地平线上方',
    'notes.sunBelow': '太阳始终在地平线下方',
    'status.noaa': 'NOAA 简化模型',
    'status.polarDay': '极昼',
    'status.polarNight': '极夜',
    'status.year': '全年叠加',
    'error.latRequired': '请输入纬度。',
    'error.latNumber': '纬度必须是数字。',
    'error.latRange': '纬度范围为 -90 到 90。',
    'error.lonRequired': '请输入经度。',
    'error.lonNumber': '经度必须是数字。',
    'error.lonRange': '经度范围为 -180 到 180。',
    'error.tzRequired': '请输入时区偏移。',
    'error.tzFormat': '格式示例：UTC+08:00 或 UTC-05:00。',
    'geo.north': 'N',
    'geo.south': 'S',
    'geo.east': 'E',
    'geo.west': 'W',
    'footer.note':
      '太阳位置与日出日落采用 NOAA 简化公式（未做额外折射修正）。晨昏带基于标准高度阈值（-6°/-12°/-18°），黄金/蓝调时刻按高度区间定义。',
  },
} as const

export type Language = keyof typeof translations
export type I18nKey = keyof typeof translations.en

export type I18nContextValue = {
  lang: Language
  t: (key: I18nKey, vars?: Record<string, string | number>) => string
}

export const I18nContext = createContext<I18nContextValue>({
  lang: 'en',
  t: (key) => translations.en[key] ?? String(key),
})

export function createTranslator(lang: Language) {
  return (key: I18nKey, vars?: Record<string, string | number>) => {
    const fallback = translations.en[key] ?? String(key)
    let text: string = translations[lang]?.[key] ?? fallback
    if (vars) {
      Object.entries(vars).forEach(([token, value]) => {
        text = text.replaceAll(`{${token}}`, String(value))
      })
    }
    return text
  }
}

export function useI18n() {
  return useContext(I18nContext)
}
